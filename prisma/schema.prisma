// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  SALEMAN
  HELPER
}

model User {
  id            String    @id
  name          String
  email         String
  emailVerified Boolean   @default(false)
  image         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @default(now()) @updatedAt
  sessions      Session[]
  accounts      Account[]
  company       Company?
  saleman       SaleMan[]
  helper        Helper[]
  customer      Customer[]
  role          Role @default(ADMIN)

  @@unique([email])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([token])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt

  @@map("verification")
}



enum Status {
  ACTIVE
  INACTIVE
}

model SaleMan {
  id        String    @id @default(uuid())
  name      String
  email     String
  status    Status    @default(ACTIVE)
  role      Role      @default(SALEMAN)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt

  invoice   Invoice[]
  userId    String
  user      User @relation(fields: [userId], references: [id])

  helpers   Helper[] @relation("SaleManHelpers")

  @@unique([name])
}

model Helper {
  id        String    @id @default(uuid())
  name      String
  email     String
  status    Status    @default(ACTIVE)
  role      Role      @default(HELPER)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt

  invoice   Invoice[]
  userId    String
  user      User @relation(fields: [userId], references: [id])

  salemen   SaleMan[] @relation("SaleManHelpers")

  @@unique([name])
}



model Company {
  id               String @id @default(uuid())
  name             String
  email            String
  image            String?
  address          String
  phoneNumber      String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @default(now()) @updatedAt
  taxId            String?
  websiteUrl       String?
  whatsappNumber   String
  user             User  @relation(fields: [userId], references:[id])
  userId           String @unique
}

enum Gender {
  FEMALE
  MALE
}

enum CustomerStatus {
  PAID
  BALANCE
  UNPAID
  PENDING
}

enum PaymentMethod {
  CC
  CA
  BANKTRANSFER
  CRYPTO
  CHECK
}

enum JacketType {
  NORMAL
  LEATHER
  WEEDING
  SPORT
  LINEN
  DENIM
  CROCODILE
  WINTER
}



enum PantType {
  NORMAL
  LEATHER
  WEEDING
  LINEN
  DENIM
  CROCODILE
  ChINO
}



enum ShirtType {
  DRESSSHIRT 
  DESIGNER
  LINEN
  TUXEDO
  POLO
}

model Jacket {
  id                 String     @id @default(uuid())
  quantity           Int 
  tailorName         String
  addVest            Boolean    @default(false)
  jacketType         JacketType @default(NORMAL)
  jacketFabricImage  String?
  jacketStyleDrawing String?
  monogramName       String?
  monogramImage      String?
  liningImage        String?
  
  ch                 Float?
  wa                 Float?
  hip                Float?
  nk                 Float?
  sh                 Float?
  sleeve             Float?
  arm                Float?
  fr                 Float?
  ba                 Float?
  lg                 Float?
  vLg                Float?
  
  invoices           Invoice[]

  @@map("jacket")
}

model Pant {
  id               String   @id @default(uuid())
  quantity         Int 
  tailorName       String
  addLining        Boolean  @default(false)
  pantType         PantType @default(NORMAL)
  pantFabricImage  String?
  pantStyleDrawing String?
  
  wa               Float?
  hip              Float?
  cr               Float?
  th               Float?
  kn               Float?
  bo               Float?
  lg               Float?
  
  invoices         Invoice[]

  @@map("pant")
}

model Shirt {
  id                  String    @id @default(uuid())
  quantity            Int 
  tailorName          String
  addTie              Boolean   @default(false)
  shirtType           ShirtType @default(DRESSSHIRT)
  shirtFabricImage    String?
  shirtStyleDrawing   String?
  shirtMonogramName   String?
  shirtMonogramImage  String?
  
  ch                  Float?
  wa                  Float?
  hip                 Float?
  nk                  Float?
  sh                  Float?
  sleeve              Float?
  arm                 Float?
  fr                  Float?
  ba                  Float?
  lg                  Float?
  vLg                 Float?
  
  invoices            Invoice[]

  @@map("shirt")
}

model Customer {
  id              String   @id @default(uuid())
  phoneNumber     String
  name            String
  address         String?
  hotel           String
  RoomNo          String
  email           String
  gender          Gender   @default(MALE)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  userId          String   @unique
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // Customer's order history
  invoices        Invoice[]

  @@map("customer")
}

model Invoice {
  id                  String         @id @default(uuid())
  invoiceNumber       String         @unique
  customerSignature   String?
  customerStatus      CustomerStatus @default(UNPAID)
  paymentMethod       PaymentMethod  @default(CA)
  totalAmount         Float?
  notes               String?
  reselling           Boolean        @default(false)
  isReadymade         Boolean        @default(false)
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  customerId          String
  customer            Customer       @relation(fields: [customerId], references: [id], onDelete: Cascade)

  salesmanId          String
  salesman            SaleMan?      @relation(fields: [salesmanId], references: [id], onDelete: SetNull)
  
  helperId            String?
  helper              Helper?        @relation(fields: [helperId], references: [id], onDelete: SetNull)

  jacketId         String
  jecket           Jacket  @relation(fields: [jacketId], references:[id])

  pantId         String
  pant           Pant  @relation(fields: [pantId], references:[id])

  shirtId         String
  shirt          Shirt  @relation(fields: [shirtId], references:[id])

}
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  SALEMAN
  HELPER
}

model User {
  id            String    @id
  name          String
  email         String
  emailVerified Boolean   @default(false)
  image         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @default(now()) @updatedAt
  sessions      Session[]
  accounts      Account[]
  company       Company?
  saleman       SaleMan[]
  helper        Helper[]
  customer      Customer[]
  invoice       Invoice[]
  role          Role @default(ADMIN)

  @@unique([email])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([token])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt

  @@map("verification")
}



enum Status {
  ACTIVE
  INACTIVE
}

model SaleMan {
  id        String    @id @default(uuid())
  name      String
  email     String
  status    Status    @default(ACTIVE)
  role      Role      @default(SALEMAN)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt

  invoice   Invoice[]
  userId    String
  user      User @relation(fields: [userId], references: [id])

  helpers   Helper[] @relation("SaleManHelpers")

  @@unique([name])
}

model Helper {
  id        String    @id @default(uuid())
  name      String
  email     String
  status    Status    @default(ACTIVE)
  role      Role      @default(HELPER)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt

  invoice   Invoice[]
  userId    String
  user      User @relation(fields: [userId], references: [id])

  salemen   SaleMan[] @relation("SaleManHelpers")

  @@unique([name])
}



model Company {
  id               String @id @default(uuid())
  name             String
  email            String
  image            String?
  address          String
  phoneNumber      String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @default(now()) @updatedAt
  taxId            String?
  websiteUrl       String?
  whatsappNumber   String
  user             User  @relation(fields: [userId], references:[id])
  userId           String @unique
}

enum Gender {
  MALE
  FEMALE
}

enum CustomerStatus {
  PAID
  BALANCE
  UNPAID
  PENDING
}

enum PaymentMethod {
  CC
  CA
  BANKTRANSFER
  CRYPTO
  CHECK
}

enum JacketType {
  NORMAL
  LEATHER
  WEEDING
  SPORT
  LINEN
  DENIM
  CROCODILE
  WINTER
}

enum PantType {
  NORMAL
  LEATHER
  WEEDING
  LINEN
  DENIM
  CROCODILE
  ChINO
}

enum PantLength {
  TROUSER
  SHORT
}

enum ShirtType {
  DRESSSHIRT
  DESIGNER
  LINEN
  TUXEDO
  POLO
  LONGSLEEVE
  SHORTSLEEVE
  DRESS
  SKIRT
  BLOUSE
}

model Jacket {
  id                 String      @id @default(uuid())
  quantity           Int?
  tailorName         String?
  fittingDate        DateTime?
  addVest            Boolean     @default(false)
  addMonogram        Boolean     @default(false)
  jacketType         JacketType?
  jacketFabricImage  String?
  jacketStyleDrawing String?
  jacketCustomStyle  String?
  monogramName       String?
  monogramImage      String?
  liningImage        String?
  
  // Measurements
  ch                 Float?
  wa                 Float?
  hip                Float?
  nk                 Float?
  sh                 Float?
  sleeve             Float?
  arm                Float?
  fr                 Float?
  ba                 Float?
  lg                 Float?
  vLg                Float?
  ocLg               Float?
  
  // Shoulder types
  nSho               Boolean     @default(false)
  sqSho              Boolean     @default(false)
  rdSho              Boolean     @default(false)
  sloSho             Boolean     @default(false)
  
  // Body characteristics
  hBk                Boolean     @default(false)
  curveBk            Boolean     @default(false)
  shoNk              Boolean     @default(false)
  bigM               Boolean     @default(false)
  
  // Additional features
  holBk              Boolean     @default(false)
  holCh              Boolean     @default(false)
  brBly              Boolean     @default(false)
  lLo                Boolean     @default(false)
  rLo                Boolean     @default(false)
  erect              Boolean     @default(false)
  flatB              Boolean     @default(false)
  
  note               String?
  
  invoices           Invoice[]

  @@map("jacket")
}

model Pant {
  id                 String       @id @default(uuid())
  quantity           Int?
  tailorName         String?
  fittingDate        DateTime?
  addInnerLining     Boolean      @default(false)
  pantType           PantType?
  pantLength         PantLength?
  pantFabricImage    String?
  pantStyleDrawing   String?
  pantCustomStyle    String?
  monogramName       String?
  monogramImage      String?
  
  // Measurements
  wa                 Float?
  hip                Float?
  cr                 Float?
  th                 Float?
  kn                 Float?
  bo                 Float?
  lg                 Float?
  
  // Style options
  slantingPkt        Boolean      @default(false)
  straightPkt        Boolean      @default(false)
  americanPkt        Boolean      @default(false)
  backRhtPkt         Boolean      @default(false)
  backLhtPkt         Boolean      @default(false)
  cuffs              Boolean      @default(false)
  wpIn               Boolean      @default(false)
  wpOut              Boolean      @default(false)
  flatB              Boolean      @default(false)
  lowFront           Boolean      @default(false)
  underBelly         Boolean      @default(false)
  
  note               String?
  
  invoices           Invoice[]

  @@map("pant")
}

model Shirt {
  id                  String     @id @default(uuid())
  quantity            Int?
  tailorName          String?
  fittingDate         DateTime?
  addMonogram         Boolean    @default(false)
  addTie              Boolean    @default(false)
  shirtType           ShirtType?
  shirtFabricImage    String?
  shirtStyleDrawing   String?
  shirtCustomStyle    String?
  shirtMonogramName   String?
  shirtMonogramImage  String?
  
  // Measurements
  ch                  Float?
  wa                  Float?
  hip                 Float?
  nk                  Float?
  sh                  Float?
  sleeve              Float?
  arm                 Float?
  fr                  Float?
  ba                  Float?
  lg                  Float?
  stb                 Float?
  stw                 Float?
  ah                  Float?
  dressLg             Float?
  skirtLg             Float?
  nLow                Float?
  
  // Style options
  sqSho               Boolean    @default(false)
  rdSho               Boolean    @default(false)
  sloSho              Boolean    @default(false)
  brBly               Boolean    @default(false)
  sloNk               Boolean    @default(false)
  
  note                String?
  
  invoices            Invoice[]

  @@map("shirt")
}

model Customer {
  id              String   @id @default(uuid())
  name            String
  phoneNumber     String
  address         String?
  email           String   @unique
  gender          Gender
  height          Float?
  weight          Float?
  stayDays        Int?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  userId          String
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  invoices        Invoice[]

  @@map("customer")
}

model Invoice {
  id                  String         @id @default(uuid())
  invoiceNumber       String         @unique
  date                DateTime
  customerStatus      CustomerStatus
  paymentMethod       PaymentMethod
  totalAmount         Float
  notes               String?
  reselling           Boolean
  isReadymade         Boolean
  isMultiSaleMan      Boolean
  customerSignature   String?
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  userId              String
  user                User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  customerId          String
  customer           Customer       @relation(fields: [customerId], references: [id], onDelete: Cascade)

  salesmanId          String
  salesman            SaleMan?      @relation(fields: [salesmanId], references: [id], onDelete: SetNull)
  
  helperId            String?
  helper              Helper?        @relation(fields: [helperId], references: [id], onDelete: SetNull)
  moreSaleMan         String[]
  

  jacketId            String?
  jacket              Jacket?        @relation(fields: [jacketId], references: [id])

  pantId              String?
  pant                Pant?          @relation(fields: [pantId], references: [id])

  shirtId             String?
  shirt               Shirt?         @relation(fields: [shirtId], references: [id])

  @@map("invoice")
}